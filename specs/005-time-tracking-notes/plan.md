# Implementation Plan: Enhanced Note-Taking & Time Tracking

**Branch**: `005-time-tracking-notes` | **Date**: 2026-01-14 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/005-time-tracking-notes/spec.md`

## Summary

Optimize Ara for capturing rich contextual notes and tracking time spent on activities. The system will extract people, topics, and locations from natural speech using the local LLM, auto-categorize entries, track activity durations via "starting X" / "done with X" commands, and provide daily/weekly time digests.

## Technical Context

**Language/Version**: Python 3.11+
**Primary Dependencies**: Existing codebase (ara.router, ara.storage, ara.llm), Ollama for entity extraction
**Storage**: MongoDB (existing) - new collections for notes, activities
**Testing**: pytest (existing test infrastructure)
**Target Platform**: Raspberry Pi 4 (8GB RAM), macOS for development
**Project Type**: Single project - extending existing ara module structure
**Performance Goals**:
- Entity extraction: <2 seconds (within LLM budget)
- Daily digest generation: <3 seconds
- Activity start/stop confirmation: <1 second
**Constraints**:
- Must work offline (use local LLM for entity extraction)
- Single active activity at a time
- Auto-close activities after 4 hours timeout
**Scale/Scope**: Personal use, hundreds of notes/activities per week

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Principle | Status | Notes |
|-----------|--------|-------|
| I. Performance-First | ✅ PASS | Entity extraction fits within 4s LLM budget; digest <3s |
| II. Offline-First | ✅ PASS | Uses local Ollama LLM for entity extraction |
| III. Modularity | ✅ PASS | New modules: notes, activities, digest - clearly separated |
| IV. Simplicity | ✅ PASS | Fixed categories, no complex ML pipelines |
| V. TDD | ✅ PASS | Will write tests first for extraction, tracking |
| VI. Benchmark-Driven | ✅ PASS | Will benchmark entity extraction latency |
| VII. Documentation-First | ✅ PASS | Will update voice command reference |

**No violations requiring justification.**

## Project Structure

### Documentation (this feature)

```text
specs/005-time-tracking-notes/
├── plan.md              # This file
├── research.md          # Entity extraction approach
├── data-model.md        # Note, Activity, Category entities
├── quickstart.md        # Usage examples
├── contracts/           # API interfaces
│   ├── note_service.py
│   ├── activity_service.py
│   └── digest_service.py
└── tasks.md             # Generated by /speckit.tasks
```

### Source Code (repository root)

```text
src/ara/
├── notes/                    # NEW: Note-taking module
│   ├── __init__.py
│   ├── extractor.py          # Entity extraction using LLM
│   ├── models.py             # Note, Person, Topic, Location
│   └── service.py            # NoteService for CRUD
├── activities/               # NEW: Activity tracking module
│   ├── __init__.py
│   ├── tracker.py            # ActivityTracker (start/stop)
│   ├── models.py             # Activity, Category
│   └── timeout.py            # Auto-close logic
├── digest/                   # NEW: Digest generation module
│   ├── __init__.py
│   ├── daily.py              # DailyDigest generator
│   ├── weekly.py             # WeeklyDigest generator
│   └── insights.py           # Pattern detection
├── router/
│   ├── intent.py             # ADD: NOTE_*, ACTIVITY_*, DIGEST_* intents
│   └── orchestrator.py       # ADD: handlers for new intents
└── storage/
    └── models.py             # ADD: NoteDTO, ActivityDTO

tests/
├── unit/
│   ├── test_extractor.py     # Entity extraction tests
│   ├── test_activity_tracker.py
│   ├── test_daily_digest.py
│   └── test_categorizer.py
└── integration/
    ├── test_note_flow.py     # E2E note capture
    └── test_activity_flow.py # E2E activity tracking
```

**Structure Decision**: Extending existing single-project structure with three new modules (notes, activities, digest) following the established pattern.

## Complexity Tracking

> No violations - table not required.
